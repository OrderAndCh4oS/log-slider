"use strict";function _classCallCheck(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function _defineProperties(t,e){for(var i=0;i<e.length;i++){var s=e[i];s.enumerable=s.enumerable||!1,s.configurable=!0,"value"in s&&(s.writable=!0),Object.defineProperty(t,s.key,s)}}function _createClass(t,e,i){return e&&_defineProperties(t.prototype,e),i&&_defineProperties(t,i),t}function _defineProperty(t,e,i){return e in t?Object.defineProperty(t,e,{value:i,enumerable:!0,configurable:!0,writable:!0}):t[e]=i,t}function _createForOfIteratorHelper(t,e){var i;if("undefined"==typeof Symbol||null==t[Symbol.iterator]){if(Array.isArray(t)||(i=_unsupportedIterableToArray(t))||e&&t&&"number"==typeof t.length){i&&(t=i);var s=0,r=function(){};return{s:r,n:function(){return s>=t.length?{done:!0}:{done:!1,value:t[s++]}},e:function(t){throw t},f:r}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var n,a=!0,o=!1;return{s:function(){i=t[Symbol.iterator]()},n:function(){var t=i.next();return a=t.done,t},e:function(t){o=!0,n=t},f:function(){try{a||null==i.return||i.return()}finally{if(o)throw n}}}}function _unsupportedIterableToArray(t,e){if(t){if("string"==typeof t)return _arrayLikeToArray(t,e);var i=Object.prototype.toString.call(t).slice(8,-1);return"Object"===i&&t.constructor&&(i=t.constructor.name),"Map"===i||"Set"===i?Array.from(t):"Arguments"===i||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(i)?_arrayLikeToArray(t,e):void 0}}function _arrayLikeToArray(t,e){(null==e||e>t.length)&&(e=t.length);for(var i=0,s=new Array(e);i<e;i++)s[i]=t[i];return s}var logScale=function(t,e,i){var s=2<arguments.length&&void 0!==i?i:0,r=Math.log(s),n=(Math.log(e)-r)/999;return Math.exp(r+n*(t-1))},inverseLogScale=function(t,e,i){var s=2<arguments.length&&void 0!==i?i:0,r=Math.log(s),n=(Math.log(e)-r)/999;return(Math.log(t)-r)/n+1},difference=function(t,e){return e<t?t-e:e-t},getClosest=function(t,e){var i,s=1/0,r=1/0,n=_createForOfIteratorHelper(t);try{for(n.s();!(i=n.n()).done;){var a=i.value,o=difference(a,e);if(s<o)break;s=o,r=a}}catch(t){n.e(t)}finally{n.f()}return r},sliderTypes=Object.freeze({LOG:"log",LINEAR:"linear"}),LogSlider=function(){function d(t){var e=this,i=t.id,s=t.step,r=t.min,n=t.max,a=t.value,o=t.type,l=t.showTab,u=t.decimalPlaces,h=t.steps,_=t.callback,p=void 0===_?function(){}:_;_classCallCheck(this,d),_defineProperty(this,"_result",void 0),_defineProperty(this,"_id",void 0),_defineProperty(this,"_logMax",void 0),_defineProperty(this,"_logMin",void 0),_defineProperty(this,"_input",void 0),_defineProperty(this,"_type",void 0),_defineProperty(this,"_tabEl",void 0),_defineProperty(this,"_decimalPlaces",void 0),_defineProperty(this,"_steps",void 0),_defineProperty(this,"_callback",void 0),_defineProperty(this,"_wrapperEl",void 0),_defineProperty(this,"_messages",void 0),_defineProperty(this,"_stepMarkersEl",void 0),_defineProperty(this,"isLogSlider",function(){return e._type===sliderTypes.LOG}),_defineProperty(this,"isLinearSlider",function(){return e._type===sliderTypes.LINEAR}),_defineProperty(this,"reset",function(){e.value=e._initialValue}),this._id=i,this._messages={elementNotFound:"No element found with id of ".concat(this._id),isNotInputElement:"".concat(this._id," is not an `<input />` tag"),isNotTypeRange:"".concat(this._id,' does not have `type="range"` set.'),notLogSliderGet:"".concat(this._id," is not a log slider, you can't 'get' a log value. Change the type to sliderTypes.LOG"),notLogSliderSet:"".concat(this._id," is not a log slider, you can't 'set' a log value. Change the type to sliderTypes.LOG")},this._input=document.getElementById(i),this._step=this._setAttribute(s,"step",1),this._min=this._setAttribute(r,"min",1),this._max=this._setAttribute(n,"max",1e3),this._initialValue=this._setAttribute(a,"value",500),this._type=this._setData(o,"type",sliderTypes.LINEAR),this._showTab=this._setData(l,"showTab",!0),this._decimalPlaces=this._setData(u,"decimalPlaces",0),this._steps=this._setData(h,"steps",null),this._callback=p,"string"==typeof this._steps&&(this._steps=this._steps.split(",").map(function(t){return Number(t)})),this._initialiseLogValue(),this._configureRangeInput(),this._createDomElements(),this._updateResult(),this._snapToStep()}return _createClass(d,[{key:"_initialiseLogValue",value:function(){this.isLogSlider()&&(this._result=logScale(this._initialValue,this._max,this._min),this._logMax=this._max,this._logMin=this._min)}},{key:"_configureRangeInput",value:function(){var t=this;if(!this._input)throw new Error(this._messages.elementNotFound);if(!this._input instanceof HTMLInputElement)throw new Error(this._messages.isNotInputElement);if("range"!==this._input.type)throw new Error(this._messages.isNotTypeRange);this._input.classList.add("range-slider"),this._input.min=this.isLogSlider()?1:this._min,this._input.max=this.isLogSlider()?1e3:this._max,this._input.step=this._step,this._input.value=this._initialValue,this._input.addEventListener("input",function(){return t._handleInputEvent()}),this._input.addEventListener("change",function(){return t._handleChangeEvent()})}},{key:"_handleInputEvent",value:function(){this._updateResult(),this._callback(this._result,this.value)}},{key:"_handleChangeEvent",value:function(){this._updateResult(),this._snapToStep(),this._callback(this._result,this.value)}},{key:"_snapToStep",value:function(){this._steps&&(this.value=this.isLogSlider()?inverseLogScale(this._result,this._logMax,this._logMin):this._result)}},{key:"_updateResult",value:function(){this._result=this.isLogSlider()?logScale(this.value,this._logMax,this._logMin):Number(this.value),this._steps&&(this._result=getClosest(this._steps,this._result)),this._showTab&&this._updateTab()}},{key:"_updateTab",value:function(){this._tabEl.innerText=this._result.toFixed(this._decimalPlaces),this._tabEl.style.left=this._getLeft(this.value,8)}},{key:"_getLeft",value:function(t,e){var i=1<arguments.length&&void 0!==e?e:0,s=Number(this.isLogSlider()?1e3:this._max);return(t-Number(this.isLogSlider()?1:this._min))/s*(this._wrapperEl.clientWidth-i)+i/2+"px"}},{key:"_createDomElements",value:function(){this._wrapperEl=this._createWrapper("range-slider--wrapper"),this._input.parentNode.insertBefore(this._wrapperEl,this._input),this._inputWrapperEl=this._createWrapper("range-slider--input-wrapper"),this._inputWrapperEl.append(this._input),this._wrapperEl.append(this._inputWrapperEl),this._showTab&&(this._tabEl=this._createTab(),this._wrapperEl.append(this._tabEl)),this._steps&&(this._stepMarkersEl=this._createStepMarkers(),this._wrapperEl.append(this._stepMarkersEl))}},{key:"_createWrapper",value:function(t){var e=document.createElement("div");return e.classList.add(t),e.style.position="relative",e}},{key:"_createTab",value:function(){var t=document.createElement("span");return t.classList.add("range-slider--tab"),this._wrapperEl.style.paddingBottom="12px",t}},{key:"_createStepMarkers",value:function(){var t=document.createElement("div");t.classList.add("range-slider--marker-container");var e,i=_createForOfIteratorHelper(this._steps);try{for(i.s();!(e=i.n()).done;){var s=e.value,r=document.createElement("div");r.classList.add("range-slider--marker");var n=this.isLogSlider()?inverseLogScale(s,this._logMax,this._logMin):s;r.style.left=this._getLeft(n,8),t.append(r)}}catch(t){i.e(t)}finally{i.f()}return t}},{key:"_setAttribute",value:function(t,e,i){return void 0!==t?t:this._input.hasAttribute(e)?this._input.getAttribute(e):i}},{key:"_setData",value:function(t,e,i){return void 0!==t?t:void 0!==this._input.dataset[e]?this._input.dataset[e]:i}},{key:"log",get:function(){if(!this.isLogSlider())throw new Error(this._messages.notLogSliderGet);return this._result},set:function(t){if(!this.isLogSlider())throw new Error(this._messages.notLogSliderSet);this._result=Math.max(this._logMin,Math.min(t,this._logMax)),this._input.value=inverseLogScale(this._result,this._logMax,this._logMin),this._updateResult()}},{key:"input",get:function(){return this._input}},{key:"value",get:function(){return this._input.value},set:function(t){this._input.value=t,this._updateResult()}}]),d}();
//# sourceMappingURL=log-slider.js.map
