"use strict";function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _defineProperties(e,t){for(var i=0;i<t.length;i++){var r=t[i];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function _createClass(e,t,i){return t&&_defineProperties(e.prototype,t),i&&_defineProperties(e,i),e}function _defineProperty(e,t,i){return t in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}function _createForOfIteratorHelper(e,t){var i;if("undefined"==typeof Symbol||null==e[Symbol.iterator]){if(Array.isArray(e)||(i=_unsupportedIterableToArray(e))||t&&e&&"number"==typeof e.length){i&&(e=i);var r=0,s=function(){};return{s:s,n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(e){throw e},f:s}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var n,a=!0,o=!1;return{s:function(){i=e[Symbol.iterator]()},n:function(){var e=i.next();return a=e.done,e},e:function(e){o=!0,n=e},f:function(){try{a||null==i.return||i.return()}finally{if(o)throw n}}}}function _unsupportedIterableToArray(e,t){if(e){if("string"==typeof e)return _arrayLikeToArray(e,t);var i=Object.prototype.toString.call(e).slice(8,-1);return"Object"===i&&e.constructor&&(i=e.constructor.name),"Map"===i||"Set"===i?Array.from(e):"Arguments"===i||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(i)?_arrayLikeToArray(e,t):void 0}}function _arrayLikeToArray(e,t){(null==t||t>e.length)&&(t=e.length);for(var i=0,r=new Array(t);i<t;i++)r[i]=e[i];return r}Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=exports.sliderTypes=exports.inverseLogScale=exports.logScale=void 0;var logScale=function(e,t,i){var r=2<arguments.length&&void 0!==i?i:0,s=Math.log(r),n=(Math.log(t)-s)/999;return Math.exp(s+n*(e-1))};exports.logScale=logScale;var inverseLogScale=function(e,t,i){var r=2<arguments.length&&void 0!==i?i:0,s=Math.log(r),n=(Math.log(t)-s)/999;return(Math.log(e)-s)/n+1};exports.inverseLogScale=inverseLogScale;var sliderTypes=Object.freeze({LOG:"log",LINEAR:"linear"});exports.sliderTypes=sliderTypes;var difference=function(e,t){return t<e?e-t:t-e},getClosest=function(e,t){var i,r=1/0,s=1/0,n=_createForOfIteratorHelper(e);try{for(n.s();!(i=n.n()).done;){var a=i.value,o=difference(a,t);if(r<o)break;r=o,s=a}}catch(e){n.e(e)}finally{n.f()}return s},LogSlider=function(){function d(e){var t=this,i=e.id,r=e.step,s=e.min,n=e.max,a=e.value,o=e.type,l=e.showTab,u=e.decimalPlaces,h=e.steps,_=e.callback,p=void 0===_?function(){}:_;_classCallCheck(this,d),_defineProperty(this,"_result",void 0),_defineProperty(this,"_id",void 0),_defineProperty(this,"_logMax",void 0),_defineProperty(this,"_logMin",void 0),_defineProperty(this,"_input",void 0),_defineProperty(this,"_type",void 0),_defineProperty(this,"_tabEl",void 0),_defineProperty(this,"_decimalPlaces",void 0),_defineProperty(this,"_steps",void 0),_defineProperty(this,"_callback",void 0),_defineProperty(this,"_wrapperEl",void 0),_defineProperty(this,"_messages",void 0),_defineProperty(this,"_stepMarkerContainerEl",void 0),_defineProperty(this,"_stepMarkerEls",[]),_defineProperty(this,"isLogSlider",function(){return t._type===sliderTypes.LOG}),_defineProperty(this,"isLinearSlider",function(){return t._type===sliderTypes.LINEAR}),_defineProperty(this,"reset",function(){t.value=t._initialValue}),this._id=i,this._messages={elementNotFound:"No element found with id of ".concat(this._id),isNotInputElement:"".concat(this._id," is not an `<input />` tag"),isNotTypeRange:"".concat(this._id,' does not have `type="range"` set.'),notLogSliderGet:"".concat(this._id," is not a log slider, you can't 'get' a log value. Change the type to sliderTypes.LOG"),notLogSliderSet:"".concat(this._id," is not a log slider, you can't 'set' a log value. Change the type to sliderTypes.LOG")},this._input=document.getElementById(i),this._step=this._setAttribute(r,"step",1),this._min=this._setAttribute(s,"min",1),this._max=this._setAttribute(n,"max",1e3),this._initialValue=this._setAttribute(a,"value",500),this._type=this._setData(o,"type",sliderTypes.LINEAR),this._showTab=this._setData(l,"showTab",!0),this._decimalPlaces=this._setData(u,"decimalPlaces",0),this._steps=this._setData(h,"steps",null),this._callback=p,"string"==typeof this._steps&&(this._steps=this._steps.split(",").map(function(e){return Number(e)})),this._initialiseLogValue(),this._configureRangeInput(),this._createDomElements(),this._updateResult(),this._snapToStep()}return _createClass(d,[{key:"_initialiseLogValue",value:function(){this.isLogSlider()&&(this._result=logScale(this._initialValue,this._max,this._min),this._logMax=this._max,this._logMin=this._min)}},{key:"_configureRangeInput",value:function(){var e=this;if(!this._input)throw new Error(this._messages.elementNotFound);if(!this._input instanceof HTMLInputElement)throw new Error(this._messages.isNotInputElement);if("range"!==this._input.type)throw new Error(this._messages.isNotTypeRange);this._input.classList.add("range-slider"),this._input.min=this.isLogSlider()?1:this._min,this._input.max=this.isLogSlider()?1e3:this._max,this._input.step=this._step,this._input.value=this._initialValue,this._input.addEventListener("input",function(){return e._handleInputEvent()}),this._input.addEventListener("change",function(){return e._handleChangeEvent()}),window.addEventListener("resize",function(){return e._updateStepMarkers()})}},{key:"_handleInputEvent",value:function(){this._updateResult(),this._callback(this._result,this.value)}},{key:"_handleChangeEvent",value:function(){this._updateResult(),this._snapToStep(),this._callback(this._result,this.value)}},{key:"_snapToStep",value:function(){this._steps&&(this.value=this.isLogSlider()?inverseLogScale(this._result,this._logMax,this._logMin):this._result)}},{key:"_updateResult",value:function(){this._result=this.isLogSlider()?logScale(this.value,this._logMax,this._logMin):Number(this.value),this._steps&&(this._result=getClosest(this._steps,this._result)),this._showTab&&this._updateTab()}},{key:"_updateTab",value:function(){this._tabEl.innerText=this._result.toFixed(this._decimalPlaces),this._tabEl.style.left=this._getLeft(this.value,8)}},{key:"_getLeft",value:function(e,t){var i=1<arguments.length&&void 0!==t?t:0,r=Number(this.isLogSlider()?1e3:this._max);return(e-Number(this.isLogSlider()?1:this._min))/r*(this._wrapperEl.clientWidth-i)+i/2+"px"}},{key:"_createDomElements",value:function(){this._wrapperEl=this._createWrapper("range-slider--wrapper"),this._input.parentNode.insertBefore(this._wrapperEl,this._input),this._inputWrapperEl=this._createWrapper("range-slider--input-wrapper"),this._inputWrapperEl.append(this._input),this._wrapperEl.append(this._inputWrapperEl),this._showTab&&(this._tabEl=this._createTab(),this._wrapperEl.append(this._tabEl)),this._steps&&(this._stepMarkerContainerEl=this._createStepMarkers(),this._wrapperEl.append(this._stepMarkerContainerEl))}},{key:"_createWrapper",value:function(e){var t=document.createElement("div");return t.classList.add(e),t.style.position="relative",t}},{key:"_createTab",value:function(){var e=document.createElement("span");return e.classList.add("range-slider--tab"),this._wrapperEl.style.paddingBottom="12px",e}},{key:"_createStepMarkers",value:function(){var e=document.createElement("div");e.classList.add("range-slider--marker-container");var t,i=_createForOfIteratorHelper(this._steps);try{for(i.s();!(t=i.n()).done;){var r=t.value,s=document.createElement("div");s.classList.add("range-slider--marker");var n=this.isLogSlider()?inverseLogScale(r,this._logMax,this._logMin):r;s.style.left=this._getLeft(n,8),e.append(s),this._stepMarkerEls.push(s)}}catch(e){i.e(e)}finally{i.f()}return e}},{key:"_updateStepMarkers",value:function(){for(var e=0;e<this._stepMarkerEls.length;e++){var t=this._stepMarkerEls[e],i=this.isLogSlider()?inverseLogScale(this._steps[e],this._logMax,this._logMin):this._steps[e];t.style.left=this._getLeft(i,8)}}},{key:"_setAttribute",value:function(e,t,i){return void 0!==e?e:this._input.hasAttribute(t)?this._input.getAttribute(t):i}},{key:"_setData",value:function(e,t,i){return void 0!==e?e:void 0!==this._input.dataset[t]?this._input.dataset[t]:i}},{key:"log",get:function(){if(!this.isLogSlider())throw new Error(this._messages.notLogSliderGet);return this._result},set:function(e){if(!this.isLogSlider())throw new Error(this._messages.notLogSliderSet);this._result=Math.max(this._logMin,Math.min(e,this._logMax)),this._input.value=inverseLogScale(this._result,this._logMax,this._logMin),this._updateResult()}},{key:"input",get:function(){return this._input}},{key:"value",get:function(){return this._input.value},set:function(e){this._input.value=e,this._updateResult()}}]),d}();exports.default=LogSlider;
//# sourceMappingURL=log-slider.js.map
