"use strict";function _classCallCheck(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function _defineProperties(t,e){for(var i=0;i<e.length;i++){var n=e[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function _createClass(t,e,i){return e&&_defineProperties(t.prototype,e),i&&_defineProperties(t,i),t}function _defineProperty(t,e,i){return e in t?Object.defineProperty(t,e,{value:i,enumerable:!0,configurable:!0,writable:!0}):t[e]=i,t}function _createForOfIteratorHelper(t,e){var i;if("undefined"==typeof Symbol||null==t[Symbol.iterator]){if(Array.isArray(t)||(i=_unsupportedIterableToArray(t))||e&&t&&"number"==typeof t.length){i&&(t=i);var n=0,r=function(){};return{s:r,n:function(){return n>=t.length?{done:!0}:{done:!1,value:t[n++]}},e:function(t){throw t},f:r}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var a,s=!0,o=!1;return{s:function(){i=t[Symbol.iterator]()},n:function(){var t=i.next();return s=t.done,t},e:function(t){o=!0,a=t},f:function(){try{s||null==i.return||i.return()}finally{if(o)throw a}}}}function _unsupportedIterableToArray(t,e){if(t){if("string"==typeof t)return _arrayLikeToArray(t,e);var i=Object.prototype.toString.call(t).slice(8,-1);return"Object"===i&&t.constructor&&(i=t.constructor.name),"Map"===i||"Set"===i?Array.from(t):"Arguments"===i||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(i)?_arrayLikeToArray(t,e):void 0}}function _arrayLikeToArray(t,e){(null==e||e>t.length)&&(e=t.length);for(var i=0,n=new Array(e);i<e;i++)n[i]=t[i];return n}var timer,logScale=function(t,e,i){var n=2<arguments.length&&void 0!==i?i:0,r=Math.log(n),a=(Math.log(e)-r)/999;return Math.exp(r+a*(t-1))},inverseLogScale=function(t,e,i){var n=2<arguments.length&&void 0!==i?i:0,r=Math.log(n),a=(Math.log(e)-r)/999;return(Math.log(t)-r)/a+1},difference=function(t,e){return e<t?t-e:e-t},snapToClosestStep=function(s,o,l){s.includes(Number(o))||(clearTimeout(timer),timer=setTimeout(function(){var t,e=1/0,i=1/0,n=_createForOfIteratorHelper(s);try{for(n.s();!(t=n.n()).done;){var r=t.value,a=difference(r,o);if(e<a)break;e=a,i=r}}catch(t){n.e(t)}finally{n.f()}l(i)},250))},sliderTypes=Object.freeze({LOG:"log",LINEAR:"linear"}),LogSlider=function(){function f(t){var e=this,i=t.id,n=t.step,r=t.min,a=t.max,s=t.value,o=t.type,l=t.showTab,u=t.decimalPlaces,h=t.steps,_=t.changeHandler,p=void 0===_?function(){}:_,d=t.inputHandler,c=void 0===d?function(){}:d;_classCallCheck(this,f),_defineProperty(this,"_id",void 0),_defineProperty(this,"_log",void 0),_defineProperty(this,"_logMax",void 0),_defineProperty(this,"_logMin",void 0),_defineProperty(this,"_input",void 0),_defineProperty(this,"_type",void 0),_defineProperty(this,"_tab",void 0),_defineProperty(this,"_decimalPlaces",void 0),_defineProperty(this,"_steps",void 0),_defineProperty(this,"_inputHandler",void 0),_defineProperty(this,"_changeHandler",void 0),_defineProperty(this,"_wrapper",void 0),_defineProperty(this,"isLogSlider",function(){return e._type===sliderTypes.LOG}),_defineProperty(this,"isLinearSlider",function(){return e._type===sliderTypes.LINEAR}),_defineProperty(this,"reset",function(){e.value=e._initialValue}),_defineProperty(this,"handleChange",function(){e.isLogSlider()?e._updateLog(e._changeHandler):e._updateValue(e._changeHandler),e._updateTab()}),_defineProperty(this,"handleInput",function(){e.isLogSlider()?e._updateLog(e._inputHandler):e._updateValue(e._inputHandler),e._updateTab()}),this._id=i,this._input=document.getElementById(i),this._step=this._setAttribute(n,"step",1),this._min=this._setAttribute(r,"min",1),this._max=this._setAttribute(a,"max",1e3),this._initialValue=this._setAttribute(s,"value",500),this._type=this._setData(o,"type",sliderTypes.LINEAR),this._showTab=this._setData(l,"showTab",!0),this._decimalPlaces=this._setData(u,"decimalPlaces",0),this._steps=this._setData(h,"steps",null),"string"==typeof this._steps&&(this._steps=this._steps.split(",").map(function(t){return Number(t)})),console.log(this._steps),this._initialiseLogValue(),this._configureRangeInput(),this._inputHandler=c,this._changeHandler=p,this._showTab&&(this._wrapper=this._createWrapper(),this._tab=this._createTab(),this._updateDom(),this._updateTab())}return _createClass(f,[{key:"_initialiseLogValue",value:function(){this.isLogSlider()&&(this._log=logScale(this._initialValue,this._max,this._min),this._logMax=this._max,this._logMin=this._min)}},{key:"_configureRangeInput",value:function(){if(!this._input)throw new Error("No element found with id of ".concat(this._id));if(!this._input instanceof HTMLInputElement)throw new Error("".concat(this._id," is not an `<input />` tag"));if("range"!==this._input.type)throw new Error("".concat(this._id,' is not does `type="range"` set.'));this._input.classList.add("range-slider"),this._input.min=this._type===sliderTypes.LOG?1:this._min,this._input.max=this._type===sliderTypes.LOG?1e3:this._max,this._input.step=this._step,this._input.value=this._initialValue,this._input.addEventListener("change",this.handleChange),this._input.addEventListener("input",this.handleInput)}},{key:"_updateDom",value:function(){this._input.parentNode.insertBefore(this._wrapper,this._input),this._wrapper.append(this._input),this._wrapper.append(this._tab)}},{key:"_createWrapper",value:function(){var t=document.createElement("div");return t.classList.add("range-slider--wrapper"),t.style.position="relative",t}},{key:"_createTab",value:function(){var t=document.createElement("span");return t.classList.add("range-slider--tab"),this._wrapper.style.paddingBottom="12px",t}},{key:"_updateTab",value:function(){var t=Number(this.isLogSlider()?this._log:this.value),e=Number(this.isLogSlider()?1e3:this._max);this._tab.innerText=t.toFixed(this._decimalPlaces),this._tab.style.left=this.value/e*(this._wrapper.clientWidth-8)+4+"px"}},{key:"_updateLog",value:function(t){this.log=logScale(this.value,this._logMax,this._logMin),t(this.value,this._log)}},{key:"_updateValue",value:function(t){this._steps?snapToClosestStep(this._steps,this.value,this._setValue(this)):t(this.value)}},{key:"_setValue",value:function(e){return function(t){e.value=t,e._changeHandler(t),e._inputHandler(t)}}},{key:"_setAttribute",value:function(t,e,i){return void 0!==t?t:this._input.hasAttribute(e)?this._input.getAttribute(e):i}},{key:"_setData",value:function(t,e,i){return void 0!==t?t:void 0!==this._input.dataset[e]?this._input.dataset[e]:i}},{key:"log",get:function(){if(!this.isLogSlider())throw new Error("".concat(this._id," is not a log slider, you can't get a log value. Change the type to sliderTypes.LOG"));return this._log},set:function(t){if(!this.isLogSlider())throw new Error("".concat(this._id," is not a log slider, you can't set a log value. Change the type to sliderTypes.LOG"));this._log=Math.max(this._logMin,Math.min(t,this._logMax)),this._input.value=inverseLogScale(this._log,this._logMax,this._logMin),this._changeHandler(this.value,this._log),this._updateTab()}},{key:"input",get:function(){return this._input}},{key:"value",get:function(){return this._input.value},set:function(t){this._input.value=t,this.isLogSlider()?this._updateLog(this._changeHandler):this._updateValue(this._changeHandler),this._updateTab()}}]),f}();
//# sourceMappingURL=log-slider.js.map
